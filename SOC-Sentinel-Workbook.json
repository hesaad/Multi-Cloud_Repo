{
    "version": "Notebook/1.0",
    "items": [
      {
        "type": 1,
        "content": {
          "json": "# Security Operations Center - hesaad"
        },
        "name": "text - 12"
      },
      {
        "type": 12,
        "content": {
          "version": "NotebookGroup/1.0",
          "groupType": "editable",
          "items": [
            {
              "type": 1,
              "content": {
                "json": "## Active Directory_Crtical_Server_Dashboard"
              },
              "name": "text - 0"
            },
            {
              "type": 9,
              "content": {
                "version": "KqlParameterItem/1.0",
                "parameters": [
                  {
                    "id": "8aea882d-05e4-416f-821a-327c88687469",
                    "version": "KqlParameterItem/1.0",
                    "name": "TimeRange",
                    "type": 4,
                    "typeSettings": {
                      "selectableValues": [
                        {
                          "durationMs": 300000
                        },
                        {
                          "durationMs": 900000
                        },
                        {
                          "durationMs": 1800000
                        },
                        {
                          "durationMs": 3600000
                        },
                        {
                          "durationMs": 14400000
                        },
                        {
                          "durationMs": 43200000
                        },
                        {
                          "durationMs": 86400000
                        },
                        {
                          "durationMs": 172800000
                        },
                        {
                          "durationMs": 259200000
                        },
                        {
                          "durationMs": 604800000
                        },
                        {
                          "durationMs": 1209600000
                        },
                        {
                          "durationMs": 2419200000
                        },
                        {
                          "durationMs": 2592000000
                        },
                        {
                          "durationMs": 5184000000
                        },
                        {
                          "durationMs": 7776000000
                        }
                      ],
                      "allowCustom": true
                    },
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "value": {
                      "durationMs": 2592000000
                    }
                  }
                ],
                "style": "pills",
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces"
              },
              "name": "parameters - 5"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "let timeRangeQuery = 90d;\r\n//Neeed to change the unhelaty time to 5minutes\r\nlet UnhealthyCriteria = 5m;\r\nHeartbeat\r\n| where TimeGenerated > startofday(ago(timeRangeQuery))\r\n| summarize LastHeartbeat = max(TimeGenerated) by Computer, OSType, OSName\r\n| extend ResultStatus = 'Unhealthy', 'failed' // change to failed\r\n| extend ResultStatus = 'Healthy', 'success'// Change to success\r\n| extend ResultStatus = iff(LastHeartbeat < ago(UnhealthyCriteria), 'Unhealthy', 'Healthy')\r\n| extend TimeFromNow = now() - LastHeartbeat\r\n| extend [\"TimeAgo\"] = strcat(toint(TimeFromNow / 1s), ' seconds')\r\n| project Computer, TimeAgo,  OSType, ResultStatus\r\n| order by TimeAgo desc\r\n",
                "size": 1,
                "title": "AD Critical Server Health Status",
                "timeContextFromParameter": "TimeRange",
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces",
                "gridSettings": {
                  "formatters": [
                    {
                      "columnMatch": "ResultStatus",
                      "formatter": 18,
                      "formatOptions": {
                        "thresholdsOptions": "icons",
                        "thresholdsGrid": [
                          {
                            "operator": "Default",
                            "thresholdValue": null,
                            "representation": "success",
                            "text": "{0}{1}"
                          },
                          {
                            "operator": "contains",
                            "thresholdValue": "Unhealthy",
                            "representation": "2",
                            "text": "{0}{1}"
                          }
                        ]
                      }
                    }
                  ],
                  "sortBy": [
                    {
                      "itemKey": "$gen_thresholds_ResultStatus_3",
                      "sortOrder": 1
                    }
                  ]
                },
                "sortBy": [
                  {
                    "itemKey": "$gen_thresholds_ResultStatus_3",
                    "sortOrder": 1
                  }
                ]
              },
              "name": "query - 1"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "Perf\r\n| where TimeGenerated > ago(7d)\r\n//| where CounterName == \"% Processor Time\" and InstanceName == \"_Total\" \r\n//| where Computer has_any ('admv1unf','ADMV1PB','AzureADSync','ADDHBD-SA','ADHOFS','admv1prt','ITDEPAPPS','admv1opm','ldap','admv1pob','admv1pwp','ADMV1OPX','ADMV1DRS','admv1dsk','admv1irs','SW-LicenseMan')\r\n| project TimeGenerated, Computer, ObjectName, CounterName, InstanceName, round(CounterValue, 2)\r\n| summarize arg_max(TimeGenerated, *) by Computer\r\n",
                "size": 1,
                "title": "AD Critical server High CPU utilization Machines",
                "timeContextFromParameter": "TimeRange",
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces",
                "visualization": "table"
              },
              "name": "query - 2"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "SecurityAlert\r\n| where TimeGenerated > ago(30d)\r\n| extend HostName_ = tostring(parse_json(Entities)[2].HostName)\r\n| where isnotempty( HostName_)\r\n//| where HostName_ in ('ADDHBD-SA','ADHOFS','admv1unf','admv1prt','admv1pwp','admv1opm','AzureADSync','ADMV1DRS','admv1pob','AzureADSync','ADMV1DRS','admv1pob','ldap','ADMV1PBI','ITDEPAPPS','ITDEPAPPS','ADMV1OPX','admv1dsk''admv1irs')\r\n| join (\r\nSecurityIncident\r\n| summarize arg_max(TimeGenerated,*) by IncidentNumber\r\n| mv-expand AlertIds to typeof(string)\r\n) on $left.SystemAlertId == $right.AlertIds\r\n| project IncidentName, IncidentNumber, AlertName, Status, Entities,  TimeGenerated,HostName_, Severity\r\n| summarize count() by Severity",
                "size": 1,
                "title": "AD Crtitical Server Involved Incident Details",
                "timeContextFromParameter": "TimeRange",
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces",
                "visualization": "piechart",
                "chartSettings": {
                  "seriesLabelSettings": [
                    {
                      "seriesName": "Medium",
                      "color": "orange"
                    },
                    {
                      "seriesName": "High",
                      "color": "red"
                    }
                  ]
                }
              },
              "name": "query - 3"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "SecurityAlert\r\n| where TimeGenerated > ago(30d)\r\n| extend HostName_ = tostring(parse_json(Entities)[2].HostName)\r\n| where isnotempty( HostName_)\r\n//| where HostName_ in ('ADDHBD-SA','ADHOFS','admv1unf','admv1prt','admv1pwp','admv1opm','AzureADSync','ADMV1DRS','admv1pob','AzureADSync','ADMV1DRS','admv1pob','ldap','ADMV1PBI','ITDEPAPPS','ITDEPAPPS','ADMV1OPX','admv1dsk''admv1irs')\r\n| join (\r\nSecurityIncident\r\n| summarize arg_max(TimeGenerated,*) by IncidentNumber\r\n| mv-expand AlertIds to typeof(string)\r\n) on $left.SystemAlertId == $right.AlertIds\r\n| project IncidentName, IncidentNumber, AlertName, Status, Entities,  TimeGenerated,HostName_\r\n| summarize count() by HostName_, AlertName, Status, IncidentNumber, TimeGenerated",
                "size": 1,
                "title": "AD Crtitical Server Involved Incident Details",
                "timeContextFromParameter": "TimeRange",
                "exportFieldName": "HostName_",
                "exportParameterName": "HostName_",
                "showExportToExcel": true,
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces",
                "gridSettings": {
                  "filter": true
                }
              },
              "name": "query - 4"
            }
          ]
        },
        "name": "group - 9"
      },
      {
        "type": 12,
        "content": {
          "version": "NotebookGroup/1.0",
          "groupType": "editable",
          "items": [
            {
              "type": 1,
              "content": {
                "json": "# Microsoft Sentinel Incident Summary "
              },
              "name": "text - 1"
            },
            {
              "type": 9,
              "content": {
                "version": "KqlParameterItem/1.0",
                "parameters": [
                  {
                    "id": "42437b13-4e1e-46d1-a844-6b57a69a6080",
                    "version": "KqlParameterItem/1.0",
                    "name": "TimeRange",
                    "type": 4,
                    "typeSettings": {
                      "selectableValues": [
                        {
                          "durationMs": 300000
                        },
                        {
                          "durationMs": 900000
                        },
                        {
                          "durationMs": 1800000
                        },
                        {
                          "durationMs": 3600000
                        },
                        {
                          "durationMs": 14400000
                        },
                        {
                          "durationMs": 43200000
                        },
                        {
                          "durationMs": 86400000
                        },
                        {
                          "durationMs": 172800000
                        },
                        {
                          "durationMs": 259200000
                        },
                        {
                          "durationMs": 604800000
                        },
                        {
                          "durationMs": 1209600000
                        },
                        {
                          "durationMs": 2419200000
                        },
                        {
                          "durationMs": 2592000000
                        },
                        {
                          "durationMs": 5184000000
                        },
                        {
                          "durationMs": 7776000000
                        }
                      ],
                      "allowCustom": true
                    },
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "value": {
                      "durationMs": 604800000
                    }
                  }
                ],
                "style": "pills",
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces"
              },
              "name": "parameters - 6"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "SecurityIncident\r\n| where TimeGenerated > ago(30d)\r\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\r\n| summarize count() by Status\r\n",
                "size": 1,
                "title": "Security Incident Current Status",
                "timeContextFromParameter": "TimeRange",
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces",
                "visualization": "piechart"
              },
              "name": "query - 2"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "SecurityIncident\r\n| summarize arg_max(TimeGenerated,*) by IncidentNumber\r\n| summarize count() by Severity",
                "size": 4,
                "title": "Security Incident By Severity",
                "timeContext": {
                  "durationMs": 86400000
                },
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces",
                "visualization": "piechart",
                "chartSettings": {
                  "seriesLabelSettings": [
                    {
                      "seriesName": "Informational",
                      "color": "gray"
                    },
                    {
                      "seriesName": "Medium",
                      "color": "orange"
                    },
                    {
                      "seriesName": "Low",
                      "color": "yellow"
                    },
                    {
                      "seriesName": "High",
                      "color": "redBright"
                    }
                  ]
                }
              },
              "name": "query - 7"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "SecurityIncident\r\n| where TimeGenerated > ago(30d)\r\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\r\n| extend Tactics = parse_json(tostring(AdditionalData.tactics))[0]\r\n| extend alertproductname = tostring(parse_json(tostring(AdditionalData.alertProductNames))[0])\r\n| summarize count() by Tactic=iff(isempty(Tactics),alertproductname,Tactics)\r\n| sort by count_ desc",
                "size": 1,
                "title": "Security Incident MITRE ATT&CK",
                "color": "gray",
                "timeContextFromParameter": "TimeRange",
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces",
                "visualization": "tiles",
                "tileSettings": {
                  "showBorder": false,
                  "titleContent": {
                    "columnMatch": "Tactic",
                    "formatter": 1
                  },
                  "leftContent": {
                    "columnMatch": "count_",
                    "formatter": 12,
                    "formatOptions": {
                      "palette": "auto"
                    },
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "maximumSignificantDigits": 3,
                        "maximumFractionDigits": 2
                      }
                    }
                  }
                },
                "graphSettings": {
                  "type": 0
                }
              },
              "name": "query - 0"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "SecurityIncident\r\n| where LastActivityTime >= ago (7d) and LastModifiedTime <= now()\r\n| where FirstModifiedTime >= ago(7d) and FirstModifiedTime <= now()\r\n| where Severity in ('*') or \"*\" in ('*')\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| where Tactics in ('*') or \"*\" in ('*')\r\n| extend Owner = todynamic(Owner.assignedTo) \r\n| where Owner in ('*') or \"*\" in ('*')\r\n| extend Product = todynamic((parse_json(tostring(AdditionalData.alertProductNames))[0])) \r\n| where Product in ('*') or \"*\" in ('*')\r\n| summarize arg_max(LastModifiedTime, *) by IncidentNumber \r\n| summarize arg_max(TimeGenerated, *) by IncidentNumber \r\n| extend TimeToDetect =  (FirstModifiedTime - CreatedTime) / 1h\r\n| extend TimeToRespond =  (LastModifiedTime - CreatedTime) / 1h\r\n| summarize MTTD=percentile(TimeToDetect, 50), MTTR=percentile(TimeToRespond, 50)by bin(CreatedTime, 1d)",
                "size": 1,
                "title": "MTTD / MTTR",
                "timeContextFromParameter": "TimeRange",
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces",
                "visualization": "barchart",
                "chartSettings": {
                  "seriesLabelSettings": [
                    {
                      "seriesName": "MTTD",
                      "color": "blue"
                    },
                    {
                      "seriesName": "MTTC",
                      "color": "redBright"
                    }
                  ],
                  "xSettings": {
                    "numberFormatSettings": {
                      "unit": 26,
                      "options": {
                        "style": "decimal",
                        "useGrouping": true
                      }
                    }
                  },
                  "ySettings": {
                    "numberFormatSettings": {
                      "unit": 25,
                      "options": {
                        "style": "decimal",
                        "useGrouping": true
                      }
                    }
                  }
                }
              },
              "name": "query - 3"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "SecurityIncident\r\n| extend assignedTo_ = tostring(Owner.assignedTo)\r\n| extend UnassignedTimestamp = iif(isnull(assignedTo_), CreatedTime, datetime(1))\r\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\r\n| where Status contains \"new\"\r\n| summarize LastUnassignment = max(UnassignedTimestamp) by CreatedTime, IncidentNumber, Severity, Title, Status\r\n| where isnotnull(LastUnassignment) and LastUnassignment < now() - 30m\r\n|  extend ActionPendingTime = datetime_diff('minute', now(), CreatedTime)//now() - CreatedTime\r\n| extend if_Trigger = iff(ActionPendingTime > 30, \"Yes\", \"No\")\r\n| where if_Trigger == \"Yes\"\r\n| project CreatedTime, Pending_Time=strcat(ActionPendingTime, \" Minutes\"), IncidentNumber, Severity, Title, Status",
                "size": 1,
                "title": "Incident Action Yet To Be Taken",
                "noDataMessageStyle": 4,
                "timeContextFromParameter": "TimeRange",
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces",
                "visualization": "table",
                "gridSettings": {
                  "filter": true
                }
              },
              "name": "query - 4"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "SecurityIncident\r\n| where CreatedTime >= ago(7d) and CreatedTime <= now()\r\n| where Severity in ('*') or \"*\" in ('*')\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| where Tactics in ('*') or \"*\" in ('*')\r\n| extend Owner = todynamic(Owner.assignedTo) \r\n| where Owner in ('*') or \"*\" in ('*')\r\n| extend Product = todynamic((parse_json(tostring(AdditionalData.alertProductNames))[0])) \r\n| where Product in ('*') or \"*\" in ('*')\r\n| summarize arg_max(FirstModifiedTime, *) by IncidentNumber \r\n| extend TimeToTriage =  FirstModifiedTime - CreatedTime\r\n| extend MinToTriage = TimeToTriage / 1h\r\n| summarize avg(TimeToTriage / 1h) by owner=case(tostring(Owner) == \"\", \"Unassigned\", tostring(Owner))\r\n",
                "size": 4,
                "title": "Mean time to triage per owner",
                "timeContext": {
                  "durationMs": 604800000
                },
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces",
                "visualization": "tiles",
                "tileSettings": {
                  "titleContent": {
                    "columnMatch": "owner",
                    "formatter": 1
                  },
                  "leftContent": {
                    "columnMatch": "avg_",
                    "formatter": 12,
                    "formatOptions": {
                      "palette": "auto"
                    },
                    "numberFormat": {
                      "unit": 26,
                      "options": {
                        "style": "decimal",
                        "maximumFractionDigits": 2,
                        "maximumSignificantDigits": 3
                      }
                    }
                  },
                  "showBorder": false
                }
              },
              "name": "query - 5"
            }
          ]
        },
        "name": "group - 16"
      },
      {
        "type": 12,
        "content": {
          "version": "NotebookGroup/1.0",
          "groupType": "editable",
          "items": [
            {
              "type": 1,
              "content": {
                "json": "## RISKY USER"
              },
              "name": "text - 0"
            },
            {
              "type": 9,
              "content": {
                "version": "KqlParameterItem/1.0",
                "parameters": [
                  {
                    "id": "3de90960-c4df-42a0-8d38-b3556dd9fd44",
                    "version": "KqlParameterItem/1.0",
                    "name": "TimeRange",
                    "type": 4,
                    "typeSettings": {
                      "selectableValues": [
                        {
                          "durationMs": 300000
                        },
                        {
                          "durationMs": 900000
                        },
                        {
                          "durationMs": 1800000
                        },
                        {
                          "durationMs": 3600000
                        },
                        {
                          "durationMs": 14400000
                        },
                        {
                          "durationMs": 43200000
                        },
                        {
                          "durationMs": 86400000
                        },
                        {
                          "durationMs": 172800000
                        },
                        {
                          "durationMs": 259200000
                        },
                        {
                          "durationMs": 604800000
                        },
                        {
                          "durationMs": 1209600000
                        },
                        {
                          "durationMs": 2419200000
                        },
                        {
                          "durationMs": 2592000000
                        },
                        {
                          "durationMs": 5184000000
                        },
                        {
                          "durationMs": 7776000000
                        }
                      ],
                      "allowCustom": true
                    },
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "value": {
                      "durationMs": 604800000
                    }
                  }
                ],
                "style": "pills",
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces"
              },
              "name": "parameters - 3"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "AADRiskyUsers\r\n| project UserDisplayName, UserPrincipalName",
                "size": 1,
                "title": "Risky User List",
                "timeContextFromParameter": "TimeRange",
                "exportFieldName": "UserPrincipalName",
                "exportParameterName": "UserPrincipalName",
                "showExportToExcel": true,
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces",
                "gridSettings": {
                  "filter": true
                }
              },
              "name": "query - 1"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "AADRiskyUsers\r\n| summarize count() by RiskLevel",
                "size": 1,
                "title": "Risky User Risk Level",
                "timeContextFromParameter": "TimeRange",
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces",
                "visualization": "piechart"
              },
              "name": "query - 2"
            }
          ]
        },
        "name": "group - 11"
      },
      {
        "type": 12,
        "content": {
          "version": "NotebookGroup/1.0",
          "groupType": "editable",
          "items": [
            {
              "type": 1,
              "content": {
                "json": "## File Integrity Monitoring"
              },
              "name": "text - 0"
            },
            {
              "type": 9,
              "content": {
                "version": "KqlParameterItem/1.0",
                "parameters": [
                  {
                    "id": "e399fafb-3b3a-498b-b72f-1133b77adba2",
                    "version": "KqlParameterItem/1.0",
                    "name": "TimeRange",
                    "type": 4,
                    "typeSettings": {
                      "selectableValues": [
                        {
                          "durationMs": 300000
                        },
                        {
                          "durationMs": 900000
                        },
                        {
                          "durationMs": 1800000
                        },
                        {
                          "durationMs": 3600000
                        },
                        {
                          "durationMs": 14400000
                        },
                        {
                          "durationMs": 43200000
                        },
                        {
                          "durationMs": 86400000
                        },
                        {
                          "durationMs": 172800000
                        },
                        {
                          "durationMs": 259200000
                        },
                        {
                          "durationMs": 604800000
                        },
                        {
                          "durationMs": 1209600000
                        },
                        {
                          "durationMs": 2419200000
                        },
                        {
                          "durationMs": 2592000000
                        },
                        {
                          "durationMs": 5184000000
                        },
                        {
                          "durationMs": 7776000000
                        }
                      ],
                      "allowCustom": true
                    },
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "value": {
                      "durationMs": 86400000
                    }
                  }
                ],
                "style": "pills",
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces"
              },
              "name": "parameters - 3"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "DeviceFileEvents\r\n| summarize count() by ActionType\r\n",
                "size": 4,
                "title": "File Event Types",
                "timeContextFromParameter": "TimeRange",
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces",
                "visualization": "tiles",
                "tileSettings": {
                  "showBorder": false,
                  "titleContent": {
                    "columnMatch": "ActionType",
                    "formatter": 1
                  },
                  "leftContent": {
                    "columnMatch": "count_",
                    "formatter": 12,
                    "formatOptions": {
                      "palette": "auto"
                    },
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "maximumSignificantDigits": 3,
                        "maximumFractionDigits": 2
                      }
                    }
                  }
                }
              },
              "name": "query - 2"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "DeviceFileEvents\r\n| where ActionType contains \"FileModified\"\r\n| project TimeGenerated,DeviceId, DeviceName, FileName,FolderPath, InitiatingProcessAccountUpn, PreviousFileName, PreviousFolderPath,InitiatingProcessFolderPath",
                "size": 0,
                "showAnalytics": true,
                "title": "File Modification Summary",
                "timeContextFromParameter": "TimeRange",
                "exportFieldName": "DeviceName",
                "exportParameterName": "DeviceName",
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces",
                "gridSettings": {
                  "filter": true
                }
              },
              "name": "query - 1"
            }
          ]
        },
        "name": "group - 11"
      },
      {
        "type": 12,
        "content": {
          "version": "NotebookGroup/1.0",
          "groupType": "editable",
          "items": [
            {
              "type": 1,
              "content": {
                "json": "## Microsoft Application Status "
              },
              "name": "text - 0"
            },
            {
              "type": 9,
              "content": {
                "version": "KqlParameterItem/1.0",
                "parameters": [
                  {
                    "id": "32b8417a-845d-43fa-bab7-6a6e937e64e7",
                    "version": "KqlParameterItem/1.0",
                    "name": "TimeRange",
                    "type": 4,
                    "isRequired": true,
                    "typeSettings": {
                      "selectableValues": [
                        {
                          "durationMs": 300000
                        },
                        {
                          "durationMs": 900000
                        },
                        {
                          "durationMs": 1800000
                        },
                        {
                          "durationMs": 3600000
                        },
                        {
                          "durationMs": 14400000
                        },
                        {
                          "durationMs": 43200000
                        },
                        {
                          "durationMs": 86400000
                        },
                        {
                          "durationMs": 172800000
                        },
                        {
                          "durationMs": 259200000
                        },
                        {
                          "durationMs": 604800000
                        },
                        {
                          "durationMs": 1209600000
                        },
                        {
                          "durationMs": 2419200000
                        },
                        {
                          "durationMs": 2592000000
                        },
                        {
                          "durationMs": 5184000000
                        },
                        {
                          "durationMs": 7776000000
                        }
                      ],
                      "allowCustom": true
                    },
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "value": {
                      "durationMs": 43200000
                    }
                  }
                ],
                "style": "pills",
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces"
              },
              "name": "parameters - 4"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "OfficeActivity\r\n|where OfficeWorkload == \"MicrosoftTeams\"\r\n|summarize count() by UserId ,Operation\r\n| top 5 by count_",
                "size": 4,
                "title": "TOP 10 Teams Operations By User",
                "timeContextFromParameter": "TimeRange",
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces",
                "visualization": "tiles",
                "tileSettings": {
                  "titleContent": {
                    "columnMatch": "UserId",
                    "formatter": 1
                  },
                  "subtitleContent": {
                    "columnMatch": "Operation",
                    "formatter": 1
                  },
                  "leftContent": {
                    "columnMatch": "count_",
                    "formatter": 12,
                    "formatOptions": {
                      "palette": "auto"
                    },
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "maximumSignificantDigits": 3,
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  "showBorder": false
                }
              },
              "name": "query - 1"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "OfficeActivity\r\n|where OfficeWorkload == \"Exchange\"\r\n|summarize count() by UserId ,Operation\r\n| top 5 by count_",
                "size": 4,
                "showAnalytics": true,
                "title": "TOP 10 Outlook Operations By User",
                "timeContextFromParameter": "TimeRange",
                "exportFieldName": "UserId",
                "exportParameterName": "UserId",
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces",
                "visualization": "table",
                "gridSettings": {
                  "filter": true
                },
                "tileSettings": {
                  "titleContent": {
                    "columnMatch": "UserId",
                    "formatter": 1
                  },
                  "subtitleContent": {
                    "columnMatch": "Operation",
                    "formatter": 1
                  },
                  "leftContent": {
                    "columnMatch": "count_",
                    "formatter": 12,
                    "formatOptions": {
                      "palette": "auto"
                    },
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "maximumSignificantDigits": 3,
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  "showBorder": false
                }
              },
              "name": "query - 2"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "OfficeActivity\r\n| where OfficeWorkload contains \"OneDrive\"\r\n| summarize count() by Operation, UserId\r\n| top 5 by count_",
                "size": 4,
                "title": "TOP 10 Onedrive Operations By User",
                "timeContextFromParameter": "TimeRange",
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces",
                "visualization": "tiles",
                "tileSettings": {
                  "titleContent": {
                    "columnMatch": "Operation",
                    "formatter": 1
                  },
                  "subtitleContent": {
                    "columnMatch": "Operation"
                  },
                  "leftContent": {
                    "columnMatch": "count_",
                    "formatter": 12,
                    "formatOptions": {
                      "palette": "auto"
                    },
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "maximumSignificantDigits": 3,
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  "showBorder": false
                }
              },
              "name": "query - 3"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "CloudAppEvents\r\n| distinct Application",
                "size": 1,
                "title": "Applications Managed by Cloud Apps",
                "timeContext": {
                  "durationMs": 86400000
                },
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces",
                "visualization": "table",
                "tileSettings": {
                  "showBorder": false
                }
              },
              "name": "query - 5"
            }
          ]
        },
        "name": "group - 12"
      },
      {
        "type": 12,
        "content": {
          "version": "NotebookGroup/1.0",
          "groupType": "editable",
          "items": [
            {
              "type": 1,
              "content": {
                "json": "## Email Usage Summary "
              },
              "name": "text - 0"
            },
            {
              "type": 9,
              "content": {
                "version": "KqlParameterItem/1.0",
                "parameters": [
                  {
                    "id": "7a354fe2-8474-4562-985d-a95b3c10bac2",
                    "version": "KqlParameterItem/1.0",
                    "name": "TimeRange",
                    "type": 4,
                    "typeSettings": {
                      "selectableValues": [
                        {
                          "durationMs": 300000
                        },
                        {
                          "durationMs": 900000
                        },
                        {
                          "durationMs": 1800000
                        },
                        {
                          "durationMs": 3600000
                        },
                        {
                          "durationMs": 14400000
                        },
                        {
                          "durationMs": 43200000
                        },
                        {
                          "durationMs": 86400000
                        },
                        {
                          "durationMs": 172800000
                        },
                        {
                          "durationMs": 259200000
                        },
                        {
                          "durationMs": 604800000
                        },
                        {
                          "durationMs": 1209600000
                        },
                        {
                          "durationMs": 2419200000
                        },
                        {
                          "durationMs": 2592000000
                        },
                        {
                          "durationMs": 5184000000
                        },
                        {
                          "durationMs": 7776000000
                        }
                      ],
                      "allowCustom": true
                    },
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "value": {
                      "durationMs": 86400000
                    }
                  }
                ],
                "style": "pills",
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces"
              },
              "name": "parameters - 3"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "OfficeActivity\r\n| where OfficeWorkload contains \"exchange\"\r\n| where Operation contains \"Send\" or Operation contains \"SendOnBehalf\"\r\n| summarize count() by MailboxOwnerUPN\r\n| top 5 by count_\r\n",
                "size": 1,
                "title": "TOP 5 User with Highest Email Send",
                "timeContextFromParameter": "TimeRange",
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces",
                "visualization": "piechart"
              },
              "name": "query - 1"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "OfficeActivity\r\n| where OfficeWorkload contains \"exchange\"\r\n| where RecordType contains \"ExchangeItem\"\r\n| where Operation contains \"MailItemsAccessed\"\r\n| summarize count() by MailboxOwnerUPN\r\n| top 5 by count_\r\n",
                "size": 4,
                "title": "TOP 5 User with Highest Email Received",
                "timeContextFromParameter": "TimeRange",
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces",
                "visualization": "tiles",
                "tileSettings": {
                  "showBorder": false,
                  "titleContent": {
                    "columnMatch": "MailboxOwnerUPN",
                    "formatter": 1
                  },
                  "leftContent": {
                    "columnMatch": "count_",
                    "formatter": 12,
                    "formatOptions": {
                      "palette": "auto"
                    },
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "maximumSignificantDigits": 3,
                        "maximumFractionDigits": 2
                      }
                    }
                  }
                }
              },
              "name": "query - 2"
            }
          ]
        },
        "name": "group - 13"
      },
      {
        "type": 12,
        "content": {
          "version": "NotebookGroup/1.0",
          "groupType": "editable",
          "items": [
            {
              "type": 1,
              "content": {
                "json": "## USER LOGIN TRACKER"
              },
              "name": "text - 0"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "SecurityEvent\r\n//|where TimeGenerated between (datetime(2023-10-09,01:00) .. datetime(2023-10-09,23:00) )\r\n|where EventID == 4624\r\n|where AccountType == \"User\"\r\n|summarize LoginTime = min(TimeGenerated) by TargetUserName\r\n|join kind = fullouter (\r\n    SecurityEvent\r\n    |where TimeGenerated between (datetime(2023-10-09,01:00) .. datetime(2023-10-09,23:00) )\r\n    | where EventID == 4634\r\n    |where AccountType == \"User\"\r\n    |summarize Logout = max(TimeGenerated) by TargetUserName\r\n) on TargetUserName\r\n|extend TotalWorkTime = datetime_diff('hour',Logout,LoginTime)\r\n|project-reorder TargetUserName, LoginTime,Logout,TotalWorkTime\r\n|sort by TotalWorkTime desc",
                "size": 0,
                "title": "User Loggin Time Duration",
                "timeContext": {
                  "durationMs": 6739200000,
                  "endTime": "2023-10-18T08:32:00.000Z"
                },
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces"
              },
              "name": "query - 1"
            }
          ]
        },
        "name": "group - 10"
      },
      {
        "type": 12,
        "content": {
          "version": "NotebookGroup/1.0",
          "groupType": "editable",
          "items": [
            {
              "type": 1,
              "content": {
                "json": "## PRIVILAGED ACCOUNT MONITORING"
              },
              "name": "text - 0"
            },
            {
              "type": 9,
              "content": {
                "version": "KqlParameterItem/1.0",
                "parameters": [
                  {
                    "id": "dff57a08-c57a-4306-8716-c425db748682",
                    "version": "KqlParameterItem/1.0",
                    "name": "TimrRange",
                    "type": 4,
                    "typeSettings": {
                      "selectableValues": [
                        {
                          "durationMs": 300000
                        },
                        {
                          "durationMs": 900000
                        },
                        {
                          "durationMs": 1800000
                        },
                        {
                          "durationMs": 3600000
                        },
                        {
                          "durationMs": 14400000
                        },
                        {
                          "durationMs": 43200000
                        },
                        {
                          "durationMs": 86400000
                        },
                        {
                          "durationMs": 172800000
                        },
                        {
                          "durationMs": 259200000
                        },
                        {
                          "durationMs": 604800000
                        },
                        {
                          "durationMs": 1209600000
                        },
                        {
                          "durationMs": 2419200000
                        },
                        {
                          "durationMs": 2592000000
                        },
                        {
                          "durationMs": 5184000000
                        },
                        {
                          "durationMs": 7776000000
                        }
                      ],
                      "allowCustom": true
                    },
                    "value": {
                      "durationMs": 7776000000
                    }
                  }
                ],
                "style": "pills",
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces"
              },
              "name": "parameters - 3"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "AuditLogs\r\n| extend userPrincipalName_ = tostring(parse_json(tostring(InitiatedBy.user)).userPrincipalName)\r\n//| where userPrincipalName_  in ('mherga@hesaad.com','aahad@hesaad.com','mmehri@hesaad.com','mhassan@hesaad.com','kal-zubail@hesaad.com','wahab1@hesaad.com')\r\n| summarize count() by Category ",
                "size": 4,
                "title": "Privilaged User Activites by Category",
                "timeContextFromParameter": "TimrRange",
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces",
                "visualization": "tiles",
                "tileSettings": {
                  "titleContent": {
                    "columnMatch": "Category",
                    "formatter": 1
                  },
                  "leftContent": {
                    "columnMatch": "count_",
                    "formatter": 12,
                    "formatOptions": {
                      "palette": "auto"
                    },
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "maximumSignificantDigits": 3,
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  "showBorder": false
                }
              },
              "showPin": false,
              "name": "query - 2"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "AuditLogs\r\n| extend userPrincipalName_ = tostring(parse_json(tostring(InitiatedBy.user)).userPrincipalName)\r\n//| where userPrincipalName_  in ('mherga@hesaad.com','aahad@hesaad.com','mmehri@hesaad.com','mhassan@hesaad.com','kal-zubail@hesaad.com','wahab1@hesaad.com')\r\n",
                "size": 0,
                "title": "Privilages User Activites",
                "timeContext": {
                  "durationMs": 86400000
                },
                "exportFieldName": "userPrincipalName_",
                "exportParameterName": "userPrincipalName_",
                "showExportToExcel": true,
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces",
                "gridSettings": {
                  "filter": true,
                  "sortBy": [
                    {
                      "itemKey": "userPrincipalName_",
                      "sortOrder": 1
                    }
                  ]
                },
                "sortBy": [
                  {
                    "itemKey": "userPrincipalName_",
                    "sortOrder": 1
                  }
                ]
              },
              "name": "query - 5"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "AuditLogs\r\n| where Category =~ \"RoleManagement\"\r\n| extend displayName_ = tostring(TargetResources[0].displayName)\r\n| where displayName_ contains \"Global Administrator\" or displayName_ contains \"Administrator\"\r\n| extend InitiatedUserid = tostring(parse_json(tostring(InitiatedBy.user)).userPrincipalName)\r\n| extend TargertUsernme = tostring(TargetResources[2].userPrincipalName)\r\n| where isnotempty(displayName_)\r\n| where isnotempty( Identity)\r\n| where isnotempty( TargertUsernme)\r\n| extend Targetuser = tostring(TargetResources[2].userPrincipalName)\r\n| project  Initiateduser=Identity , Assignedrole=displayName_ ,Targetuser, OperationName,Result,AADOperationType, InitiatedUserid",
                "size": 1,
                "showAnalytics": true,
                "title": "New User Assigned With Administrator Role",
                "timeContextFromParameter": "TimrRange",
                "exportFieldName": "Assignedrole",
                "exportParameterName": "Assignedrole",
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces",
                "gridSettings": {
                  "filter": true
                }
              },
              "name": "query - 1"
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "DeviceFileEvents\r\n| where ActionType contains \"File\"\r\n| where ActionType contains \"FileCreated\"\r\n| where InitiatingProcessFileName contains \"OUTLOOK.EXE\"\r\n//| where InitiatingProcessAccountUpn in ('mherga@hesaad.com','aahad@hesaad.com','mmehri@hesaad.com','mhassan@hesaad.com','kal-zubail@hesaad.com','wahab1@hesaad.com')\r\n| summarize count() by InitiatingProcessAccountUpn\r\n",
                "size": 4,
                "title": "Email Downloaded By Admin Users",
                "timeContext": {
                  "durationMs": 86400000
                },
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces",
                "visualization": "piechart"
              },
              "name": "query - 4"
            }
          ]
        },
        "name": "group - 10"
      }
    ],
    "fallbackResourceIds": [
      "/subscriptions/d1d8779d-38d7-4f06-91db-9cbc8de0176f/resourcegroups/soc/providers/microsoft.operationalinsights/workspaces/cybersecuritysoc"
    ],
    "fromTemplateId": "https://sentinelus.hosting.portal.azure.net/sentinelus/Content/1.0.02484.3403-231021-003920/Scenarios/Ecosystem/Content/Workbooks/CustomWorkbook.json",
    "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
  }